!function(){"use strict";var e=class{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._closeByEscape=this._closeByEscape.bind(this),this._closeByMouseDown=this._closeByMouseDown.bind(this)}open(){this._popupElement.classList.add("modal_opened"),this._setEventListeners()}close(){this._popupElement.classList.remove("modal_opened"),this._popupElement.removeEventListener("click",this._closeByMouseDown),document.removeEventListener("keydown",this._closeByEscape)}_closeByEscape=e=>{"Escape"===e.key&&this.close()};_closeByMouseDown=e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__close"))&&this.close()};_setEventListeners(){document.addEventListener("keydown",this._closeByEscape),this._popupElement.addEventListener("click",this._closeByMouseDown)}},t=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formEl=t}_showInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_hasInvalidInput(){return!this._inputEls.every((e=>e.validity.valid))}toggleButtonState(){if(this._hasInvalidInput())return this._submitButton.classList.add(this._inactiveButtonClass),void(this._submitButton.disabled=!0);this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_setEventListeners(){this._inputEls=[...this._formEl.querySelectorAll(this._inputSelector)],this._submitButton=this._formEl.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._formEl.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners(this._formEl)}},s=class extends e{constructor(e,t){super({popupSelector:e}),this._handleFormSubmit=t,this._popupForm=this._popupElement.querySelector(".modal__form"),this._inputs=this._popupForm.querySelectorAll(".modal__input"),this._submitButton=this._popupForm.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent}setLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";e?(this._submitButton.textContent=t,this._submitButton.disabled=!0):(this._submitButton.textContent=this._submitButtonText,this._submitButton.disabled=!1)}close(){this._popupForm.reset(),this._popupElement.removeEventListener("submit",this._submitForm),super.close()}_getInputValues(){const e={};return this._inputs.forEach((t=>{""!==t.value&&(e[t.name]=t.value)})),e}_submitForm=()=>{const e=this._getInputValues();this._handleFormSubmit(e)};_setEventListeners(){super._setEventListeners(),this._popupElement.addEventListener("submit",this._submitForm)}};const i={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},r=document.querySelector("#profile-edit-button"),n=document.querySelector("#profile-edit-modal"),o=document.querySelector("#profile-title-input"),a=document.querySelector("#profile-description-input"),l=n.querySelector(".modal__form"),u=document.querySelector("#add-form-modal"),c=document.querySelector("#profile-add-button"),_=u.querySelector(".modal__form"),d=document.querySelector(".cards__list"),h=document.querySelector(".profile__edit__photo"),m=document.querySelector("#profile-avatar-form"),p=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_handleServerResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}_request(e,t){return fetch(e,t).then(this._handleServerResponse)}getInitialCards(){return this._request(`${this._baseUrl}/cards`,{headers:this._headers})}getUserInfo(){return this._request(`${this._baseUrl}/users/me`,{headers:this._headers})}setUserInfo(e,t){return this._request(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})})}addCard(e){let{name:t,link:s}=e;return this._request(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})})}removeCard(e){return this._request(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers})}changeLikeStatus(e,t){return this._request(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers})}setUserAvatar(e){return console.log("url:"+e),this._request(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"bf54a6ce-ba6a-4742-a5e8-9bdd0fb7708a","Content-Type":"application/json"}});let E;const v=new class{constructor(e,t,s){this._nameElement=e,this._jobElement=t,this._avatarElement=s}getUserInfo(){const e={};return e.profileName=this._nameElement.textContent,e.description=this._jobElement.textContent,e}setUserInfo(e,t){this._nameElement.textContent=e,this._jobElement.textContent=t}setUserAvatar(e){console.log(e),this._avatarElement.src=e,this._avatarElement.alt=this._nameElement.textContent}}(document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector(".profile__image"));Promise.all([p.getInitialCards(),p.getUserInfo()]).then((e=>{let[t,s]=e;v.setUserInfo(s.name,s.about),v.setUserAvatar(s.avatar),E=new class{constructor(e,t){let{items:s,renderer:i}=e;this._items=s,this._renderer=i,this._containerElement=t}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._containerElement.prepend(e)}prependItem(e){this._containerElement.prepend(e)}}({items:t,renderer:e=>{const t=B(e);E.addItem(t)}},d),E.renderItems()})).catch(console.error);const b=new class extends e{constructor(e){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._submitButton=this._popupForm.querySelector(".form__button_type_delete"),this._submitButtonText=this._submitButton.textContent}setSubmitAction(e){this._handleFormSubmit=e}setLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Removing...";e?(this._submitButton.textContent=t,this._submitButton.disabled=!0):(this._submitButton.textContent=this._submitButtonText,this._submitButton.disabled=!1)}_setEventListeners(){super._setEventListeners(),this._formSubmitHandler=e=>{e.preventDefault(),this._handleFormSubmit(e)},this._popupForm.addEventListener("submit",this._formSubmitHandler)}_removeEventListeners(){super._removeEventListeners(),this._popupForm.removeEventListener("submit",this._formSubmitHandler)}}("#modal-card-delete"),S=new s("#modal-avatar-edit",(function(e){let{url:t}=e;S.setLoading(!0),p.setUserAvatar(t).then((e=>{v.setUserAvatar(e.avatar),S.close()})).catch(console.error).finally((()=>{S.setLoading(!1)}))})),L=new class extends e{constructor(e){super({popupSelector:e}),this._previewImageElement=document.querySelector(".modal__preview-image"),this._previewImageDescription=document.querySelector(".modal__preview-description")}open(e,t){this._previewImageElement.alt=e,this._previewImageDescription.textContent=e,this._previewImageElement.src=t,super.open()}}("#preview-modal"),g=new s("#profile-edit-modal",(function(e){const{nameInfo:t,jobInfo:s}=e;g.setLoading(!0),p.setUserInfo(t,s).then((()=>{console.log("here"),v.setUserInfo(t,s),g.close()})).catch(console.error).finally((()=>{g.setLoading(!1)}))})),f=new s("#add-form-modal",(function(e){const{name:t,link:s}=e;f.setLoading(!0),p.addCard({name:t,link:s}).then((e=>{const t=B(e);E.prependItem(t),f.close()})).catch(console.error).finally((()=>{f.setLoading(!1)}))}));function y(e){let{name:t,link:s}=e;L.open(t,s)}function B(e){const t=new class{constructor(e,t,s,i,r,n,o){this._name=e.name,this._link=e.link,this.isLiked=e.isLiked,this._templateSelector=t,this._handleCardImageClick=s,this._previewImageModal=n,this._previewDescriptionModal=o,this._handleDeleteClick=i,this._handleLikeButtonClick=r}removeCardElement(){this._cardElement.remove()}_getTemplate(){return this._cardElement=document.querySelector(`${this._templateSelector}`).content.querySelector(".card").cloneNode(!0),this._cardElement}_handleDeleteButton(){this._cardElement.remove(),this._cardElement=null}_toggleLikeButton(){this.isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}updateLikes(e){this.isLiked=e,this._toggleLikeButton()}_handleLikeButton(){this._likeButton.classList.toggle("card__like-button_active")}_setEventListeners(){this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._handleCardImageClick({name:this._name,link:this._link})})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>this._handleDeleteClick())),this._cardElement.querySelector(".card__like-button").addEventListener("click",(()=>this._handleLikeButtonClick()))}getCardElement(){return this._cardElement=this._getTemplate(),this._setEventListeners(),this._cardElement.querySelector(".card__title").textContent=this._name,this._cardElement.querySelector(".card__image").src=this._link,this._cardElement.querySelector(".card__image").alt=this._name,this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._toggleLikeButton(),this._cardElement}}(e,"#card-template",y,(function(){b.setSubmitAction((()=>{b.setLoading(!0),p.removeCard(e._id).then((e=>{t.removeCardElement(e._id),b.close()})).catch(console.error).finally((()=>{b.setLoading(!1)}))})),b.open()}),(function(){p.changeLikeStatus(e._id,t.isLiked).then((e=>t.updateLikes(e.isLiked))).catch(console.error)}));return t.getCardElement()}c.addEventListener("click",(()=>{k.toggleButtonState(),f.open()})),r.addEventListener("click",(()=>{const{profileName:e,description:t}=v.getUserInfo();o.value=e,a.value=t,C.toggleButtonState(),g.open()})),h.addEventListener("click",(()=>{q.toggleButtonState(),S.open()}));const k=new t(i,_);k.enableValidation();const C=new t(i,l);C.enableValidation();const q=new t(i,m);q.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBNENBLE1BNUNBLE1BQ0VBLFlBQVdDLEdBQW9CLElBQW5CLGNBQUVDLEdBQWVELEVBQzNCRSxLQUFLQyxjQUFnQkMsU0FBU0MsY0FBY0osR0FDNUNDLEtBQUtJLGVBQWlCSixLQUFLSSxlQUFlQyxLQUFLTCxNQUMvQ0EsS0FBS00sa0JBQW9CTixLQUFLTSxrQkFBa0JELEtBQUtMLEtBQ3ZELENBR0FPLE9BQ0VQLEtBQUtDLGNBQWNPLFVBQVVDLElBQUksZ0JBQ2pDVCxLQUFLVSxvQkFDUCxDQUdBQyxRQUNFWCxLQUFLQyxjQUFjTyxVQUFVSSxPQUFPLGdCQUNwQ1osS0FBS0MsY0FBY1ksb0JBQW9CLFFBQVNiLEtBQUtNLG1CQUNyREosU0FBU1csb0JBQW9CLFVBQVdiLEtBQUtJLGVBQy9DLENBR0FBLGVBQWtCVSxJQUNGLFdBQVZBLEVBQUVDLEtBQ0pmLEtBQUtXLE9BQ1AsRUFJRkwsa0JBQXFCUSxLQUVqQkEsRUFBRUUsT0FBT1IsVUFBVVMsU0FBUyxVQUM1QkgsRUFBRUUsT0FBT1IsVUFBVVMsU0FBUyxrQkFFNUJqQixLQUFLVyxPQUNQLEVBSUZELHFCQUNFUixTQUFTZ0IsaUJBQWlCLFVBQVdsQixLQUFLSSxnQkFDMUNKLEtBQUtDLGNBQWNpQixpQkFBaUIsUUFBU2xCLEtBQUtNLGtCQUNwRCxHQ3VDRixFQWhGQSxNQUVFVCxZQUFZc0IsRUFBUUMsR0FFbEJwQixLQUFLcUIsZUFBaUJGLEVBQU9HLGNBQzdCdEIsS0FBS3VCLHNCQUF3QkosRUFBT0sscUJBQ3BDeEIsS0FBS3lCLHFCQUF1Qk4sRUFBT08sb0JBQ25DMUIsS0FBSzJCLGlCQUFtQlIsRUFBT1MsZ0JBQy9CNUIsS0FBSzZCLFlBQWNWLEVBQU9XLFdBRzFCOUIsS0FBS29CLFFBQVVBLENBQ2pCLENBR0FXLGdCQUFnQkMsR0FDZCxNQUFNQyxFQUFpQmpDLEtBQUtvQixRQUFRakIsY0FBZSxJQUFHNkIsRUFBUUUsWUFDOURGLEVBQVF4QixVQUFVQyxJQUFJVCxLQUFLMkIsa0JBQzNCTSxFQUFlRSxZQUFjSCxFQUFRSSxrQkFDckNILEVBQWV6QixVQUFVQyxJQUFJVCxLQUFLNkIsWUFDcEMsQ0FHQVEsZ0JBQWdCTCxHQUNkLE1BQU1DLEVBQWlCakMsS0FBS29CLFFBQVFqQixjQUFlLElBQUc2QixFQUFRRSxZQUM5REYsRUFBUXhCLFVBQVVJLE9BQU9aLEtBQUsyQixrQkFDOUJNLEVBQWVFLFlBQWMsR0FDN0JGLEVBQWV6QixVQUFVSSxPQUFPWixLQUFLNkIsWUFDdkMsQ0FHQVMsb0JBQW9CTixHQUNsQixJQUFLQSxFQUFRTyxTQUFTQyxNQUNwQixPQUFPeEMsS0FBSytCLGdCQUFnQkMsR0FFOUJoQyxLQUFLcUMsZ0JBQWdCTCxFQUN2QixDQUdBUyxtQkFDRSxPQUFRekMsS0FBSzBDLFVBQVVDLE9BQU9YLEdBQVlBLEVBQVFPLFNBQVNDLE9BQzdELENBR0FJLG9CQUNFLEdBQUk1QyxLQUFLeUMsbUJBR1AsT0FGQXpDLEtBQUs2QyxjQUFjckMsVUFBVUMsSUFBSVQsS0FBS3lCLDJCQUN0Q3pCLEtBQUs2QyxjQUFjQyxVQUFXLEdBSWhDOUMsS0FBSzZDLGNBQWNyQyxVQUFVSSxPQUFPWixLQUFLeUIsc0JBQ3pDekIsS0FBSzZDLGNBQWNDLFVBQVcsQ0FDaEMsQ0FHQXBDLHFCQUNFVixLQUFLMEMsVUFBWSxJQUFJMUMsS0FBS29CLFFBQVEyQixpQkFBaUIvQyxLQUFLcUIsaUJBQ3hEckIsS0FBSzZDLGNBQWdCN0MsS0FBS29CLFFBQVFqQixjQUFjSCxLQUFLdUIsdUJBRXJEdkIsS0FBSzBDLFVBQVVNLFNBQVNoQixJQUN0QkEsRUFBUWQsaUJBQWlCLFNBQVVKLElBQ2pDZCxLQUFLc0Msb0JBQW9CTixHQUN6QmhDLEtBQUs0QyxtQkFBbUIsR0FDeEIsR0FFTixDQUdBSyxtQkFFRWpELEtBQUtvQixRQUFRRixpQkFBaUIsVUFBV0osSUFDdkNBLEVBQUVvQyxnQkFBZ0IsSUFJcEJsRCxLQUFLVSxtQkFBbUJWLEtBQUtvQixRQUMvQixHQ1BGLEVBbEVBLGNBQTRCK0IsRUFDMUJ0RCxZQUFZRSxFQUFlcUQsR0FFekJDLE1BQU0sQ0FBRXRELGtCQUdSQyxLQUFLc0Qsa0JBQW9CRixFQUd6QnBELEtBQUt1RCxXQUFhdkQsS0FBS0MsY0FBY0UsY0FBYyxnQkFDbkRILEtBQUt3RCxRQUFVeEQsS0FBS3VELFdBQVdSLGlCQUFpQixpQkFDaEQvQyxLQUFLNkMsY0FBZ0I3QyxLQUFLdUQsV0FBV3BELGNBQWMsa0JBQ25ESCxLQUFLeUQsa0JBQW9CekQsS0FBSzZDLGNBQWNWLFdBQzlDLENBR0F1QixXQUFXQyxHQUFzQyxJQUEzQkMsRUFBV0MsVUFBQUMsT0FBQSxRQUFBQyxJQUFBRixVQUFBLEdBQUFBLFVBQUEsR0FBRyxZQUM5QkYsR0FDRjNELEtBQUs2QyxjQUFjVixZQUFjeUIsRUFDakM1RCxLQUFLNkMsY0FBY0MsVUFBVyxJQUU5QjlDLEtBQUs2QyxjQUFjVixZQUFjbkMsS0FBS3lELGtCQUN0Q3pELEtBQUs2QyxjQUFjQyxVQUFXLEVBRWxDLENBR0FuQyxRQUVFWCxLQUFLdUQsV0FBV1MsUUFHaEJoRSxLQUFLQyxjQUFjWSxvQkFBb0IsU0FBVWIsS0FBS2lFLGFBR3REWixNQUFNMUMsT0FDUixDQUdBdUQsa0JBQ0UsTUFBTUMsRUFBZSxDQUFDLEVBTXRCLE9BTEFuRSxLQUFLd0QsUUFBUVIsU0FBU29CLElBQ0EsS0FBaEJBLEVBQU1DLFFBQ1JGLEVBQWFDLEVBQU1FLE1BQVFGLEVBQU1DLE1BQ25DLElBRUtGLENBQ1QsQ0FHQUYsWUFBY0EsS0FDWixNQUFNTSxFQUFjdkUsS0FBS2tFLGtCQUN6QmxFLEtBQUtzRCxrQkFBa0JpQixFQUFZLEVBSXJDN0QscUJBRUUyQyxNQUFNM0MscUJBR05WLEtBQUtDLGNBQWNpQixpQkFBaUIsU0FBVWxCLEtBQUtpRSxZQUNyRCxHQzdCSyxNQUFNTyxFQUFzQixDQUNqQ2xELGNBQWUsZ0JBQ2ZFLHFCQUFzQixpQkFDdEJFLG9CQUFxQix5QkFDckJFLGdCQUFpQiwwQkFDakJFLFdBQVksd0JBSUQyQyxFQUFvQnZFLFNBQVNDLGNBQWMsd0JBQzNDdUUsRUFBbUJ4RSxTQUFTQyxjQUFjLHVCQUMxQ3dFLEVBQW9CekUsU0FBU0MsY0FBYyx3QkFDM0N5RSxFQUEwQjFFLFNBQVNDLGNBQzlDLDhCQUVXMEUsRUFBa0JILEVBQWlCdkUsY0FBYyxnQkFHakQyRSxFQUFlNUUsU0FBU0MsY0FBYyxtQkFDdEM0RSxFQUFtQjdFLFNBQVNDLGNBQWMsdUJBQzFDNkUsRUFBcUJGLEVBQWEzRSxjQUFjLGdCQUdoRDhFLEVBQVkvRSxTQUFTQyxjQUFjLGdCQUduQytFLEVBQW1CaEYsU0FBU0MsY0FBYyx5QkFDMUNnRixFQUFtQmpGLFNBQVNDLGNBQWMsd0JDL0JqRGlGLEVBQU0sSUMvQkcsTUFFYnZGLFlBQVdDLEdBQXVCLElBQXRCLFFBQUV1RixFQUFPLFFBQUVDLEdBQVN4RixFQUM5QkUsS0FBS3VGLFNBQVdGLEVBQ2hCckYsS0FBS3dGLFNBQVdGLENBQ2xCLENBR0FHLHNCQUFzQkMsR0FDcEIsT0FBT0EsRUFBSUMsR0FBS0QsRUFBSUUsT0FBU0MsUUFBUUMsT0FBUSxVQUFTSixFQUFJSyxTQUM1RCxDQUdBQyxTQUFTQyxFQUFLQyxHQUNaLE9BQU9DLE1BQU1GLEVBQUtDLEdBQVNFLEtBQUtwRyxLQUFLeUYsc0JBQ3ZDLENBR0FZLGtCQUlFLE9BSGlCckcsS0FBS2dHLFNBQVUsR0FBRWhHLEtBQUt1RixpQkFBa0IsQ0FDdkRELFFBQVN0RixLQUFLd0YsVUFHbEIsQ0FHQWMsY0FJRSxPQUhpQnRHLEtBQUtnRyxTQUFVLEdBQUVoRyxLQUFLdUYsb0JBQXFCLENBQzFERCxRQUFTdEYsS0FBS3dGLFVBR2xCLENBR0FlLFlBQVlqQyxFQUFNa0MsR0FDaEIsT0FBT3hHLEtBQUtnRyxTQUFVLEdBQUVoRyxLQUFLdUYsb0JBQXFCLENBQ2hEa0IsT0FBUSxRQUNSbkIsUUFBU3RGLEtBQUt3RixTQUNka0IsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQnRDLEtBQU1BLEVBQ051QyxNQUFPTCxLQUdiLENBR0FNLFFBQU9DLEdBQWlCLElBQWhCLEtBQUV6QyxFQUFJLEtBQUUwQyxHQUFNRCxFQUNwQixPQUFPL0csS0FBS2dHLFNBQVUsR0FBRWhHLEtBQUt1RixpQkFBa0IsQ0FDN0NrQixPQUFRLE9BQ1JuQixRQUFTdEYsS0FBS3dGLFNBQ2RrQixLQUFNQyxLQUFLQyxVQUFVLENBQ25CdEMsT0FDQTBDLFVBR04sQ0FHQUMsV0FBV0MsR0FDVCxPQUFPbEgsS0FBS2dHLFNBQVUsR0FBRWhHLEtBQUt1RixrQkFBa0IyQixJQUFVLENBQ3ZEVCxPQUFRLFNBQ1JuQixRQUFTdEYsS0FBS3dGLFVBRWxCLENBR0EyQixpQkFBaUJELEVBQVFFLEdBQ3ZCLE9BQU9wSCxLQUFLZ0csU0FBVSxHQUFFaEcsS0FBS3VGLGtCQUFrQjJCLFVBQWdCLENBQzdEVCxPQUFRVyxFQUFVLFNBQVcsTUFDN0I5QixRQUFTdEYsS0FBS3dGLFVBRWxCLENBR0E2QixjQUFjcEIsR0FFWixPQURBcUIsUUFBUUMsSUFBSSxPQUFTdEIsR0FDZGpHLEtBQUtnRyxTQUFVLEdBQUVoRyxLQUFLdUYsMkJBQTRCLENBQ3ZEa0IsT0FBUSxRQUNSbkIsUUFBU3RGLEtBQUt3RixTQUNka0IsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQlksT0FBUXZCLEtBR2QsR0RwRGtCLENBQ2xCWixRQUxpQixrREFNakJDLFFBQVMsQ0FDUG1DLGNBTGUsdUNBTWYsZUFBZ0Isc0JBSXBCLElBQUlDLEVBSUosTUFBTUMsRUFBVyxJRTdDakIsTUFDRTlILFlBQVkrSCxFQUFhQyxFQUFZTCxHQUNuQ3hILEtBQUs4SCxhQUFlRixFQUNwQjVILEtBQUsrSCxZQUFjRixFQUNuQjdILEtBQUtnSSxlQUFpQlIsQ0FDeEIsQ0FHQWxCLGNBQ0UsTUFBTTJCLEVBQWEsQ0FBQyxFQUdwQixPQUZBQSxFQUFXQyxZQUFjbEksS0FBSzhILGFBQWEzRixZQUMzQzhGLEVBQVd6QixZQUFjeEcsS0FBSytILFlBQVk1RixZQUNuQzhGLENBQ1QsQ0FHQTFCLFlBQVk0QixFQUFVQyxHQUNwQnBJLEtBQUs4SCxhQUFhM0YsWUFBY2dHLEVBQ2hDbkksS0FBSytILFlBQVk1RixZQUFjaUcsQ0FDakMsQ0FFQWYsY0FBY0csR0FDWkYsUUFBUUMsSUFBSUMsR0FDWnhILEtBQUtnSSxlQUFlSyxJQUFNYixFQUMxQnhILEtBQUtnSSxlQUFlTSxJQUFNdEksS0FBSzhILGFBQWEzRixXQUM5QyxHRnFCQWpDLFNBQVNDLGNBQWMsbUJBQ3ZCRCxTQUFTQyxjQUFjLHlCQUN2QkQsU0FBU0MsY0FBYyxvQkFHekIwRixRQUFRMEMsSUFBSSxDQUFDbkQsRUFBSWlCLGtCQUFtQmpCLEVBQUlrQixnQkFDckNGLE1BQUt0RyxJQUE4QixJQUE1QjBJLEVBQWNDLEdBQVMzSSxFQUM3QjZILEVBQVNwQixZQUFZa0MsRUFBU25FLEtBQU1tRSxFQUFTNUIsT0FDN0NjLEVBQVNOLGNBQWNvQixFQUFTakIsUUFFaENFLEVBQWMsSUd4RGxCLE1BQ0U3SCxZQUFXQyxFQUFzQjRJLEdBQWtCLElBQXZDLE1BQUVDLEVBQUssU0FBRUMsR0FBVTlJLEVBQzdCRSxLQUFLNkksT0FBU0YsRUFDZDNJLEtBQUs4SSxVQUFZRixFQUNqQjVJLEtBQUsrSSxrQkFBb0JMLENBQzNCLENBR0FNLGNBQ0VoSixLQUFLNkksT0FBTzdGLFNBQVNpRyxJQUNuQmpKLEtBQUs4SSxVQUFVRyxFQUFLLEdBRXhCLENBU0FDLFFBQVFDLEdBQ05uSixLQUFLK0ksa0JBQWtCSyxRQUFRRCxFQUNqQyxDQUdBRSxZQUFZRixHQUNWbkosS0FBSytJLGtCQUFrQkssUUFBUUQsRUFDakMsR0g2QkksQ0FDRVIsTUFBT0gsRUFDUEksU0FBV1UsSUFDVCxNQUFNSCxFQUFjSSxFQUFXRCxHQUMvQjVCLEVBQVl3QixRQUFRQyxFQUFZLEdBR3BDbEUsR0FFRnlDLEVBQVlzQixhQUFhLElBRTFCUSxNQUFNbEMsUUFBUW1DLE9BRWpCLE1BQU1DLEVBQWtCLElJbkVULGNBQStCdkcsRUFDNUN0RCxZQUFZRSxHQUVWc0QsTUFBTSxDQUFFdEQsa0JBR1JDLEtBQUt1RCxXQUFhdkQsS0FBS0MsY0FBY0UsY0FBYyxnQkFDbkRILEtBQUs2QyxjQUFnQjdDLEtBQUt1RCxXQUFXcEQsY0FDbkMsNkJBRUZILEtBQUt5RCxrQkFBb0J6RCxLQUFLNkMsY0FBY1YsV0FDOUMsQ0FHQXdILGdCQUFnQkMsR0FDZDVKLEtBQUtzRCxrQkFBb0JzRyxDQUMzQixDQUdBbEcsV0FBV0MsR0FBd0MsSUFBN0JDLEVBQVdDLFVBQUFDLE9BQUEsUUFBQUMsSUFBQUYsVUFBQSxHQUFBQSxVQUFBLEdBQUcsY0FDOUJGLEdBQ0YzRCxLQUFLNkMsY0FBY1YsWUFBY3lCLEVBQ2pDNUQsS0FBSzZDLGNBQWNDLFVBQVcsSUFFOUI5QyxLQUFLNkMsY0FBY1YsWUFBY25DLEtBQUt5RCxrQkFDdEN6RCxLQUFLNkMsY0FBY0MsVUFBVyxFQUVsQyxDQUdBcEMscUJBQ0UyQyxNQUFNM0MscUJBR05WLEtBQUs2SixtQkFBc0IvSSxJQUN6QkEsRUFBRW9DLGlCQUNGbEQsS0FBS3NELGtCQUFrQnhDLEVBQUUsRUFJM0JkLEtBQUt1RCxXQUFXckMsaUJBQWlCLFNBQVVsQixLQUFLNkosbUJBQ2xELENBR0FDLHdCQUNFekcsTUFBTXlHLHdCQUNOOUosS0FBS3VELFdBQVcxQyxvQkFBb0IsU0FBVWIsS0FBSzZKLG1CQUNyRCxHSm9CMkMsc0JBQ3ZDRSxFQUFrQixJQUFJQyxFQUMxQixzQkFJRixTQUErQmpELEdBQVUsSUFBVCxJQUFFZCxHQUFLYyxFQUNyQ2dELEVBQWdCckcsWUFBVyxHQUMzQjBCLEVBQ0dpQyxjQUFjcEIsR0FDZEcsTUFBTXFDLElBQ0xkLEVBQVNOLGNBQWNvQixFQUFTakIsUUFDaEN1QyxFQUFnQnBKLE9BQU8sSUFFeEI2SSxNQUFNbEMsUUFBUW1DLE9BQ2RRLFNBQVEsS0FDUEYsRUFBZ0JyRyxZQUFXLEVBQU0sR0FFdkMsSUFHYXdHLEVBQW9CLElLekZqQyxjQUE2Qi9HLEVBQzNCdEQsWUFBWUUsR0FDVnNELE1BQU0sQ0FBRXRELGtCQUNSQyxLQUFLbUsscUJBQXVCakssU0FBU0MsY0FBYyx5QkFDbkRILEtBQUtvSyx5QkFBMkJsSyxTQUFTQyxjQUN2Qyw4QkFFSixDQUdBSSxLQUFLK0QsRUFBTTBDLEdBQ1RoSCxLQUFLbUsscUJBQXFCN0IsSUFBTWhFLEVBQ2hDdEUsS0FBS29LLHlCQUF5QmpJLFlBQWNtQyxFQUM1Q3RFLEtBQUttSyxxQkFBcUI5QixJQUFNckIsRUFDaEMzRCxNQUFNOUMsTUFDUixHTDBFa0Qsa0JBR3ZDOEosRUFBZ0IsSUFBSUwsRUFDL0IsdUJBMEVGLFNBQWlDTSxHQUMvQixNQUFNLFNBQUVuQyxFQUFRLFFBQUVDLEdBQVlrQyxFQUM5QkQsRUFBYzNHLFlBQVcsR0FDekIwQixFQUNHbUIsWUFBWTRCLEVBQVVDLEdBQ3RCaEMsTUFBSyxLQUNKa0IsUUFBUUMsSUFBSSxRQUNaSSxFQUFTcEIsWUFBWTRCLEVBQVVDLEdBQy9CaUMsRUFBYzFKLE9BQU8sSUFFdEI2SSxNQUFNbEMsUUFBUW1DLE9BQ2RRLFNBQVEsS0FDUEksRUFBYzNHLFlBQVcsRUFBTSxHQUVyQyxJQW5GYTZHLEVBQW1CLElBQUlQLEVBQ2xDLG1CQXFGRixTQUFpQ3pGLEdBQy9CLE1BQU0sS0FBRUQsRUFBSSxLQUFFMEMsR0FBU3pDLEVBQ3ZCZ0csRUFBaUI3RyxZQUFXLEdBQzVCMEIsRUFDRzBCLFFBQVEsQ0FBRXhDLE9BQU0wQyxTQUNoQlosTUFBTWtELElBQ0wsTUFBTUgsRUFBY0ksRUFBV0QsR0FDL0I1QixFQUFZMkIsWUFBWUYsR0FDeEJvQixFQUFpQjVKLE9BQU8sSUFFekI2SSxNQUFNbEMsUUFBUW1DLE9BQ2RRLFNBQVEsS0FDUE0sRUFBaUI3RyxZQUFXLEVBQU0sR0FFeEMsSUE5RkEsU0FBUzhHLEVBQW9CQyxHQUFpQixJQUFoQixLQUFFbkcsRUFBSSxLQUFFMEMsR0FBTXlELEVBQzFDUCxFQUFrQjNKLEtBQUsrRCxFQUFNMEMsRUFDL0IsQ0F1QkEsU0FBU3VDLEVBQVdELEdBQ2xCLE1BQU1ILEVBQWMsSU1wSXRCLE1BR0V0SixZQUNFNkssRUFDQUMsRUFDQUgsRUFDQUksRUFDQUMsRUFDQUMsRUFDQUMsR0FFQS9LLEtBQUtnTCxNQUFRTixFQUFLcEcsS0FFbEJ0RSxLQUFLaUwsTUFBUVAsRUFBSzFELEtBQ2xCaEgsS0FBS29ILFFBQVVzRCxFQUFLdEQsUUFDcEJwSCxLQUFLa0wsa0JBQW9CUCxFQUN6QjNLLEtBQUttTCxzQkFBd0JYLEVBQzdCeEssS0FBS29MLG1CQUFxQk4sRUFDMUI5SyxLQUFLcUwseUJBQTJCTixFQUNoQy9LLEtBQUtzTCxtQkFBcUJWLEVBQzFCNUssS0FBS3VMLHVCQUF5QlYsQ0FDaEMsQ0FFQVcsb0JBQ0V4TCxLQUFLeUwsYUFBYTdLLFFBQ3BCLENBR0E4SyxlQUtFLE9BSkExTCxLQUFLeUwsYUFBZXZMLFNBQ2pCQyxjQUFlLEdBQUVILEtBQUtrTCxxQkFDdEJTLFFBQVF4TCxjQUFjLFNBQ3RCeUwsV0FBVSxHQUNONUwsS0FBS3lMLFlBQ2QsQ0FXQUksc0JBQ0U3TCxLQUFLeUwsYUFBYTdLLFNBQ2xCWixLQUFLeUwsYUFBZSxJQUN0QixDQUVBSyxvQkFDTTlMLEtBQUtvSCxRQUNQcEgsS0FBSytMLFlBQVl2TCxVQUFVQyxJQUFJLDRCQUUvQlQsS0FBSytMLFlBQVl2TCxVQUFVSSxPQUFPLDJCQUV0QyxDQUVBb0wsWUFBWTVFLEdBQ1ZwSCxLQUFLb0gsUUFBVUEsRUFDZnBILEtBQUs4TCxtQkFDUCxDQUdBRyxvQkFFRWpNLEtBQUsrTCxZQUFZdkwsVUFBVTBMLE9BQU8sMkJBQ3BDLENBR0F4TCxxQkFFRVYsS0FBS3lMLGFBQ0Z0TCxjQUFjLGdCQUNkZSxpQkFBaUIsU0FBUyxLQUN6QmxCLEtBQUttTCxzQkFBc0IsQ0FBRTdHLEtBQU10RSxLQUFLZ0wsTUFBT2hFLEtBQU1oSCxLQUFLaUwsT0FBUSxJQUl0RWpMLEtBQUt5TCxhQUNGdEwsY0FBYyx3QkFDZGUsaUJBQWlCLFNBQVMsSUFBTWxCLEtBQUtzTCx1QkFHeEN0TCxLQUFLeUwsYUFDRnRMLGNBQWMsc0JBQ2RlLGlCQUFpQixTQUFTLElBQU1sQixLQUFLdUwsMEJBSzFDLENBR0FZLGlCQVlFLE9BWEFuTSxLQUFLeUwsYUFBZXpMLEtBQUswTCxlQUN6QjFMLEtBQUtVLHFCQUNMVixLQUFLeUwsYUFBYXRMLGNBQWMsZ0JBQWdCZ0MsWUFBY25DLEtBQUtnTCxNQUNuRWhMLEtBQUt5TCxhQUFhdEwsY0FBYyxnQkFBZ0JrSSxJQUFNckksS0FBS2lMLE1BQzNEakwsS0FBS3lMLGFBQWF0TCxjQUFjLGdCQUFnQm1JLElBQU10SSxLQUFLZ0wsTUFDM0RoTCxLQUFLb00sY0FBZ0JwTSxLQUFLeUwsYUFBYXRMLGNBQ3JDLHdCQUVGSCxLQUFLK0wsWUFBYy9MLEtBQUt5TCxhQUFhdEwsY0FBYyxzQkFDbkRILEtBQUs4TCxvQkFFRTlMLEtBQUt5TCxZQUNkLEdOeUJFbkMsRUFDQSxpQkFDQWtCLEdBQ0EsV0FDRWQsRUFBZ0JDLGlCQUFnQixLQUM5QkQsRUFBZ0JoRyxZQUFXLEdBQzNCMEIsRUFDRzZCLFdBQVdxQyxFQUFTK0MsS0FDcEJqRyxNQUFNVixJQUNMeUQsRUFBWXFDLGtCQUFrQjlGLEVBQUkyRyxLQUNsQzNDLEVBQWdCL0ksT0FBTyxJQUV4QjZJLE1BQU1sQyxRQUFRbUMsT0FDZFEsU0FBUSxLQUNQUCxFQUFnQmhHLFlBQVcsRUFBTSxHQUNqQyxJQUdOZ0csRUFBZ0JuSixNQUNsQixJQUNBLFdBQ0U2RSxFQUNHK0IsaUJBQWlCbUMsRUFBUytDLElBQUtsRCxFQUFZL0IsU0FDM0NoQixNQUFNVixHQUFReUQsRUFBWTZDLFlBQVl0RyxFQUFJMEIsV0FDMUNvQyxNQUFNbEMsUUFBUW1DLE1BQ25CLElBR0YsT0FBT04sRUFBWWdELGdCQUNyQixDQW5EQXBILEVBQWlCN0QsaUJBQWlCLFNBQVMsS0FDekNvTCxFQUFpQjFKLG9CQUNqQjJILEVBQWlCaEssTUFBTSxJQUl6QmtFLEVBQWtCdkQsaUJBQWlCLFNBQVMsS0FDMUMsTUFBTSxZQUFFZ0gsRUFBVyxZQUFFMUIsR0FBZ0JtQixFQUFTckIsY0FDOUMzQixFQUFrQk4sTUFBUTZELEVBQzFCdEQsRUFBd0JQLE1BQVFtQyxFQUNoQytGLEVBQWtCM0osb0JBQ2xCeUgsRUFBYzlKLE1BQU0sSUFHdEIyRSxFQUFpQmhFLGlCQUFpQixTQUFTLEtBQ3pDc0wsRUFBb0I1SixvQkFDcEJtSCxFQUFnQnhKLE1BQU0sSUFnRnhCLE1BQU0rTCxFQUFtQixJQUFJRyxFQUMzQmpJLEVBQ0FRLEdBRUZzSCxFQUFpQnJKLG1CQUdqQixNQUFNc0osRUFBb0IsSUFBSUUsRUFDNUJqSSxFQUNBSyxHQUVGMEgsRUFBa0J0SixtQkFFbEIsTUFBTXVKLEVBQXNCLElBQUlDLEVBQzlCakksRUFDQVcsR0FFRnFILEVBQW9Cdkosa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpOyAvLyBUaGUgcG9wdXAgZWxlbWVudCB0byBtYW5pcHVsYXRlXG4gICAgdGhpcy5fY2xvc2VCeUVzY2FwZSA9IHRoaXMuX2Nsb3NlQnlFc2NhcGUuYmluZCh0aGlzKTsgLy8gQmluZHMgdGhlIGNsb3NlQnlFc2NhcGUgbWV0aG9kIHRvIHRoZSBjbGFzcyBpbnN0YW5jZVxuICAgIHRoaXMuX2Nsb3NlQnlNb3VzZURvd24gPSB0aGlzLl9jbG9zZUJ5TW91c2VEb3duLmJpbmQodGhpcyk7IC8vIEJpbmRzIHRoZSBjbG9zZUJ5TW91c2VEb3duIG1ldGhvZCB0byB0aGUgY2xhc3MgaW5zdGFuY2VcbiAgfVxuXG4gIC8vIE9wZW5zIHRoZSBwb3B1cFxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpOyAvLyBBZGRzIHRoZSBcIm1vZGFsX29wZW5lZFwiIGNsYXNzIHRvIHNob3cgdGhlIHBvcHVwXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTsgLy8gU2V0cyB1cCBldmVudCBsaXN0ZW5lcnMgdG8gaGFuZGxlIGNsb3NpbmcgdGhlIHBvcHVwXG4gIH1cblxuICAvLyBDbG9zZXMgdGhlIHBvcHVwXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpOyAvLyBSZW1vdmVzIHRoZSBcIm1vZGFsX29wZW5lZFwiIGNsYXNzIHRvIGhpZGUgdGhlIHBvcHVwXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9jbG9zZUJ5TW91c2VEb3duKTsgLy8gUmVtb3ZlcyB0aGUgZXZlbnQgbGlzdGVuZXIgZm9yIGNsb3NpbmcgYnkgbW91c2UgZG93blxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2Nsb3NlQnlFc2NhcGUpOyAvLyBSZW1vdmVzIHRoZSBldmVudCBsaXN0ZW5lciBmb3IgY2xvc2luZyBieSBFc2NhcGUga2V5XG4gIH1cblxuICAvLyBDbG9zZXMgdGhlIHBvcHVwIHdoZW4gdGhlIEVzY2FwZSBrZXkgaXMgcHJlc3NlZFxuICBfY2xvc2VCeUVzY2FwZSA9IChlKSA9PiB7XG4gICAgaWYgKGUua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7IC8vIENhbGxzIHRoZSBjbG9zZSBtZXRob2QgdG8gY2xvc2UgdGhlIHBvcHVwXG4gICAgfVxuICB9O1xuXG4gIC8vIENsb3NlcyB0aGUgcG9wdXAgd2hlbiBjbGlja2VkIG91dHNpZGUgdGhlIHBvcHVwIG9yIG9uIHRoZSBjbG9zZSBidXR0b25cbiAgX2Nsb3NlQnlNb3VzZURvd24gPSAoZSkgPT4ge1xuICAgIGlmIChcbiAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpIHx8XG4gICAgICBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2VcIilcbiAgICApIHtcbiAgICAgIHRoaXMuY2xvc2UoKTsgLy8gQ2FsbHMgdGhlIGNsb3NlIG1ldGhvZCB0byBjbG9zZSB0aGUgcG9wdXBcbiAgICB9XG4gIH07XG5cbiAgLy8gU2V0cyB1cCBldmVudCBsaXN0ZW5lcnMgZm9yIGNsb3NpbmcgdGhlIHBvcHVwXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9jbG9zZUJ5RXNjYXBlKTsgLy8gTGlzdGVucyBmb3IgdGhlIEVzY2FwZSBrZXlkb3duIGV2ZW50IHRvIGNsb3NlIHRoZSBwb3B1cFxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5fY2xvc2VCeU1vdXNlRG93bik7IC8vIExpc3RlbnMgZm9yIG1vdXNlIGRvd24gZXZlbnRzIHRvIGNsb3NlIHRoZSBwb3B1cFxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBvcHVwO1xuIiwiY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIC8vIENvbnN0cnVjdG9yIGZ1bmN0aW9uIHRoYXQgaW5pdGlhbGl6ZXMgdGhlIEZvcm1WYWxpZGF0b3IgaW5zdGFuY2VcbiAgY29uc3RydWN0b3IoY29uZmlnLCBfZm9ybUVsKSB7XG4gICAgLy8gQ29uZmlndXJhdGlvbiBvcHRpb25zXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IGNvbmZpZy5pbnB1dFNlbGVjdG9yO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBjb25maWcuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBjb25maWcuZXJyb3JDbGFzcztcblxuICAgIC8vIFRoZSBmb3JtIGVsZW1lbnRcbiAgICB0aGlzLl9mb3JtRWwgPSBfZm9ybUVsO1xuICB9XG5cbiAgLy8gRGlzcGxheXMgdGhlIGlucHV0IGVycm9yIG1lc3NhZ2UgYW5kIGFwcGxpZXMgZXJyb3Igc3R5bGVzIHRvIHRoZSBpbnB1dCBlbGVtZW50XG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIC8vIEhpZGVzIHRoZSBpbnB1dCBlcnJvciBtZXNzYWdlIGFuZCByZW1vdmVzIGVycm9yIHN0eWxlcyBmcm9tIHRoZSBpbnB1dCBlbGVtZW50XG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIC8vIENoZWNrcyB0aGUgdmFsaWRpdHkgb2YgYW4gaW5wdXQgZWxlbWVudCBhbmQgc2hvd3MvaGlkZXMgZXJyb3IgbWVzc2FnZXMgYWNjb3JkaW5nbHlcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCk7XG4gICAgfVxuICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xuICB9XG5cbiAgLy8gQ2hlY2tzIGlmIHRoZSBmb3JtIGhhcyBhbnkgaW52YWxpZCBpbnB1dHNcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICByZXR1cm4gIXRoaXMuX2lucHV0RWxzLmV2ZXJ5KChpbnB1dEVsKSA9PiBpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKTtcbiAgfVxuXG4gIC8vIFRvZ2dsZXMgdGhlIHN0YXRlIG9mIHRoZSBzdWJtaXQgYnV0dG9uIGJhc2VkIG9uIGZvcm0gdmFsaWRpdHlcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gIH1cblxuICAvLyBTZXRzIHVwIGV2ZW50IGxpc3RlbmVycyBmb3IgaW5wdXQgZWxlbWVudHNcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2lucHV0RWxzID0gWy4uLnRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG5cbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoZSkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCk7XG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gRW5hYmxlcyBmb3JtIHZhbGlkYXRpb24gYnkgc2V0dGluZyB1cCBuZWNlc3NhcnkgZXZlbnQgbGlzdGVuZXJzXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgLy8gUHJldmVudHMgZm9ybSBzdWJtaXNzaW9uIGFuZCBoYW5kbGVzIHZhbGlkYXRpb24gbWFudWFsbHlcbiAgICB0aGlzLl9mb3JtRWwuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuXG4gICAgLy8gU2V0cyB1cCBldmVudCBsaXN0ZW5lcnMgZm9yIGlucHV0IGVsZW1lbnRzXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnModGhpcy5fZm9ybUVsKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yO1xuIiwiLy8gSW1wb3J0IHRoZSBiYXNlIFBvcHVwIGNsYXNzIGZyb20gaXRzIGZpbGUgcGF0aFxuaW1wb3J0IFBvcHVwIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwLmpzXCI7XG5cbi8vIENsYXNzIGZvciBhIHBvcHVwIHdpdGggYSBmb3JtIHRoYXQgZXh0ZW5kcyB0aGUgYmFzZSBQb3B1cCBjbGFzc1xuY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIC8vIENhbGwgdGhlIGNvbnN0cnVjdG9yIG9mIHRoZSBwYXJlbnQgY2xhc3MgKFBvcHVwKSBhbmQgcGFzcyB0aGUgcG9wdXBTZWxlY3RvclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcblxuICAgIC8vIFN0b3JlIHRoZSBmdW5jdGlvbiB0byBoYW5kbGUgZm9ybSBzdWJtaXNzaW9uXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG5cbiAgICAvLyBTdG9yZSByZWZlcmVuY2VzIHRvIHBvcHVwIGZvcm0gZWxlbWVudHNcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9pbnB1dHMgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIik7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xuICB9XG5cbiAgLy8gQ29udHJvbCB0aGUgbG9hZGluZyBzdGF0ZSBvZiB0aGUgc3VibWl0IGJ1dHRvblxuICBzZXRMb2FkaW5nKGlzTG9hZGluZywgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiKSB7XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdXR0b25UZXh0O1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLy8gT3ZlcnJpZGVzIHRoZSBjbG9zZSBtZXRob2Qgb2YgdGhlIHBhcmVudCBjbGFzcyAoUG9wdXApIHRvIGluY2x1ZGUgYWRkaXRpb25hbCBmdW5jdGlvbmFsaXR5XG4gIGNsb3NlKCkge1xuICAgIC8vIFJlc2V0IHRoZSBmb3JtIGlucHV0cyB3aXRoaW4gdGhlIHBvcHVwXG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XG5cbiAgICAvLyBSZW1vdmUgdGhlIHN1Ym1pdCBoYW5kbGVyIGZyb20gdGhlIHBvcHVwIGVsZW1lbnRcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLl9zdWJtaXRGb3JtKTtcblxuICAgIC8vIENhbGwgdGhlIGNsb3NlIG1ldGhvZCBvZiB0aGUgcGFyZW50IGNsYXNzIHRvIGNsb3NlIHRoZSBwb3B1cFxuICAgIHN1cGVyLmNsb3NlKCk7XG4gIH1cblxuICAvLyBSZXRyaWV2ZXMgdGhlIHZhbHVlcyBvZiB0aGUgZm9ybSBpbnB1dHMgYW5kIHJldHVybnMgdGhlbSBhcyBhbiBvYmplY3RcbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGlucHV0c09iamVjdCA9IHt9O1xuICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaWYgKGlucHV0LnZhbHVlICE9PSBcIlwiKSB7XG4gICAgICAgIGlucHV0c09iamVjdFtpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBpbnB1dHNPYmplY3Q7XG4gIH1cblxuICAvLyBTdWJtaXRzIHRoZSBmb3JtIGJ5IGNhbGxpbmcgdGhlIGhhbmRsZUZvcm1TdWJtaXQgZnVuY3Rpb24gd2l0aCB0aGUgaW5wdXQgdmFsdWVzXG4gIF9zdWJtaXRGb3JtID0gKCkgPT4ge1xuICAgIGNvbnN0IGlucHV0VmFsdWVzID0gdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KGlucHV0VmFsdWVzKTtcbiAgfTtcblxuICAvLyBTZXRzIHVwIGV2ZW50IGxpc3RlbmVycyBmb3IgdGhlIHBvcHVwXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAvLyBTZXRzIHVwIGV2ZW50IGxpc3RlbmVycyBpbmhlcml0ZWQgZnJvbSB0aGUgcGFyZW50IGNsYXNzIChQb3B1cClcbiAgICBzdXBlci5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIC8vIExpc3RlbiBmb3IgZm9ybSBzdWJtaXNzaW9uIHRvIHRyaWdnZXIgdGhlIF9zdWJtaXRGb3JtIG1ldGhvZFxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX3N1Ym1pdEZvcm0pO1xuICB9XG59XG5cbi8vIEV4cG9ydCB0aGUgUG9wdXBXaXRoRm9ybSBjbGFzc1xuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoRm9ybTtcbiIsIi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFycmF5cyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8vIGV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4vLyAgIHtcbi8vICAgICBuYW1lOiBcIlNlYXR0bGUsIFdBXCIsXG4vLyAgICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTUwMjE3NTM1MzE3NC1hN2E3MGU3M2IzNjI/aXhsaWI9cmItNC4wLjMmaXhpZD1NM3d4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OGZBJTNEJTNEJmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9MTQyNiZxPTgwXCIsXG4vLyAgIH0sXG4vLyAgIHtcbi8vICAgICBuYW1lOiBcIkRlbnZlciwgQ09cIixcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vd3d3LjU1cGxhY2VzLmNvbS93cC1jb250ZW50L3VwbG9hZHMvMjAyMi8xMS9kb3dudG93bi1kZW52ZXItY29sb3JhZG8uanBnXCIsXG4vLyAgIH0sXG4vLyAgIHtcbi8vICAgICBuYW1lOiBcIk9ybGFuZG8sIEZMXCIsXG4vLyAgICAgbGluazogXCJodHRwczovL3dvcmxkc3RyaWRlcy5jb20vd3AtY29udGVudC91cGxvYWRzLzIwMTYvMDYvaVN0b2NrXzU4MDY4ODU0X0xBUkdFLmpwZ1wiLFxuLy8gICB9LFxuLy8gICB7XG4vLyAgICAgbmFtZTogXCJMYXMgVmVnYXMsIE5WXCIsXG4vLyAgICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTU4MTM1MTcyMTAxMC04Y2Y4NTljYjE0YTQ/aXhsaWI9cmItNC4wLjMmaXhpZD1NM3d4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OGZBJTNEJTNEJmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9MTQ3MCZxPTgwXCIsXG4vLyAgIH0sXG4vLyAgIHtcbi8vICAgICBuYW1lOiBcIlNhbnRhIE1vbmljYSwgQ0FcIixcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNDk4MTk2NjQ1MTQ1LTY4N2ZkM2JmZTkxMj9peGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4ZkElM0QlM0QmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz0xNDcwJnE9ODBcIixcbi8vICAgfSxcblxuLy8gICB7XG4vLyAgICAgbmFtZTogXCJKdW5lYXUsIEFLXCIsXG4vLyAgICAgbGluazogXCJodHRwczovL3d3dy5tYXJra2VsbGV5LmNvbS93cC1jb250ZW50L3VwbG9hZHMvMjAxOS8xMS9vcnRoZXJuX0xpZ2h0c19NZW5kZW5oYWxsX0dsYWNpZXJfSnVuZWF1X2NhbGVuZGFyXzIwMTcxMTA4X01lbmRlbmhhbGxfR2xhY2llcl9Ob3J0aGVybl9MaWdodHNfMDYxLUVkaXQtNy1FZGl0LTUtRWRpdC0yLTk0MHg2NTguanBnXCIsXG4vLyAgIH0sXG4vLyBdO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ29uc3RhbnRzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8vIENvbmZpZ3VyYXRpb24gZm9yIGZvcm0gdmFsaWRhdGlvblxuZXhwb3J0IGNvbnN0IGZvcm1WYWxpZGF0b3JDb25maWcgPSB7XG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLCAvLyBTZWxlY3RvciBmb3IgaW5wdXQgZmllbGRzIHdpdGhpbiBhIG1vZGFsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsIC8vIFNlbGVjdG9yIGZvciBzdWJtaXQgYnV0dG9uIHdpdGhpbiBhIG1vZGFsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLCAvLyBDbGFzcyB0byBkaXNhYmxlIHRoZSBzdWJtaXQgYnV0dG9uXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLCAvLyBDbGFzcyB0byBtYXJrIGlucHV0IGZpZWxkcyB3aXRoIGVycm9yc1xuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsIC8vIENsYXNzIHRvIG1ha2UgZXJyb3IgbWVzc2FnZXMgdmlzaWJsZVxufTtcblxuLy8gUHJvZmlsZSBFZGl0IFNlY3Rpb25cbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LWJ1dHRvblwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtbW9kYWxcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZVRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtdGl0bGUtaW5wdXRcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCJcbik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuXG4vLyBBZGQgQ2FyZCBTZWN0aW9uXG5leHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtZm9ybS1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBhZGROZXdDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWFkZC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUFkZENhcmRGb3JtID0gYWRkQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5cbi8vIENhcmRzIFNlY3Rpb25cbmV4cG9ydCBjb25zdCBjYXJkc1dyYXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xuXG4vLyBBdmF0YXIgRWRpdCBTZWN0aW9uXG5leHBvcnQgY29uc3QgYXZhdGFyRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdF9fcGhvdG9cIik7XG5leHBvcnQgY29uc3QgYXZhdGFyU3VibWl0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1hdmF0YXItZm9ybVwiKTtcbiIsIi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSW1wb3J0cyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbmltcG9ydCBQb3B1cFdpdGhDb25maXJtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm0uanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQge1xuICBpbml0aWFsQ2FyZHMsXG4gIGZvcm1WYWxpZGF0b3JDb25maWcsXG4gIHByb2ZpbGVFZGl0QnV0dG9uLFxuICBwcm9maWxlVGl0bGVJbnB1dCxcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQsXG4gIHByb2ZpbGVFZGl0Rm9ybSxcbiAgYWRkTmV3Q2FyZEJ1dHRvbixcbiAgcHJvZmlsZUFkZENhcmRGb3JtLFxuICBjYXJkc1dyYXAsXG4gIGF2YXRhckVkaXRCdXR0b24sXG4gIGF2YXRhclN1Ym1pdEZvcm0sXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZ1bmN0aW9ucyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuY29uc3QgYmFja2VuZFVSTCA9IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIjtcbi8vQVBJXG5jb25zdCB2YWxpZGF0aW9uID0gXCJiZjU0YTZjZS1iYTZhLTQ3NDItYTVlOC05YmRkMGZiNzcwOGFcIjtcblxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IGJhY2tlbmRVUkwsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiB2YWxpZGF0aW9uLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbmxldCBjYXJkU2VjdGlvbjtcbmxldCB1c2VySWQ7XG5cbi8vIFVzZXIgaW5mb3JtYXRpb25cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKFxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RpdGxlXCIpLFxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpLFxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlXCIpXG4pO1xuXG5Qcm9taXNlLmFsbChbYXBpLmdldEluaXRpYWxDYXJkcygpLCBhcGkuZ2V0VXNlckluZm8oKV0pXG4gIC50aGVuKChbaW5pdGlhbENhcmRzLCB1c2VyRGF0YV0pID0+IHtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyRGF0YS5uYW1lLCB1c2VyRGF0YS5hYm91dCk7XG4gICAgdXNlckluZm8uc2V0VXNlckF2YXRhcih1c2VyRGF0YS5hdmF0YXIpO1xuICAgIC8vIHVzZXJJZCA9IHVzZXJEYXRhLl9pZDtcbiAgICBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICAgICAge1xuICAgICAgICBpdGVtczogaW5pdGlhbENhcmRzLFxuICAgICAgICByZW5kZXJlcjogKGNhcmREYXRhKSA9PiB7XG4gICAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSByZW5kZXJDYXJkKGNhcmREYXRhKTtcbiAgICAgICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBjYXJkc1dyYXBcbiAgICApO1xuICAgIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XG4gIH0pXG4gIC5jYXRjaChjb25zb2xlLmVycm9yKTtcblxuY29uc3QgY2FyZERlbGV0ZVBvcHVwID0gbmV3IFBvcHVwV2l0aENvbmZpcm0oXCIjbW9kYWwtY2FyZC1kZWxldGVcIik7XG5jb25zdCBhdmF0YXJFZGl0UG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIjbW9kYWwtYXZhdGFyLWVkaXRcIixcbiAgaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdFxuKTtcblxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdCh7IHVybCB9KSB7XG4gIGF2YXRhckVkaXRQb3B1cC5zZXRMb2FkaW5nKHRydWUpO1xuICBhcGlcbiAgICAuc2V0VXNlckF2YXRhcih1cmwpXG4gICAgLnRoZW4oKHVzZXJEYXRhKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKHVzZXJEYXRhLmF2YXRhcik7XG4gICAgICBhdmF0YXJFZGl0UG9wdXAuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGF2YXRhckVkaXRQb3B1cC5zZXRMb2FkaW5nKGZhbHNlKTtcbiAgICB9KTtcbn1cblxuLy8gUG9wdXAgZm9yIGltYWdlIHByZXZpZVxuZXhwb3J0IGNvbnN0IHByZXZpZXdJbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI3ByZXZpZXctbW9kYWxcIik7XG5cbi8vIFBvcHVwIGZvciBwcm9maWxlIGVkaXQgZm9ybVxuZXhwb3J0IGNvbnN0IGVkaXRQb3B1cEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIsXG4gIGhhbmRsZUVkaXRQcm9maWxlU3VibWl0XG4pO1xuXG4vLyBQb3B1cCBmb3IgYWRkIGNhcmQgZm9ybVxuZXhwb3J0IGNvbnN0IGFkZENhcmRQb3B1cEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIjYWRkLWZvcm0tbW9kYWxcIixcbiAgaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXRcbik7XG5cbi8vIEV2ZW50IGhhbmRsZXIgZm9yIGNhcmQgaW1hZ2UgY2xpY2sgKG9wZW5zIHByZXZpZXcgcG9wdXApXG5mdW5jdGlvbiBoYW5kbGVDYXJkSW1hZ2VDbGljayh7IG5hbWUsIGxpbmsgfSkge1xuICBwcmV2aWV3SW1hZ2VQb3B1cC5vcGVuKG5hbWUsIGxpbmspO1xufVxuXG4vLyBFdmVudCBsaXN0ZW5lciBmb3IgYWRkIG5ldyBjYXJkIGJ1dHRvbiBjbGlja1xuYWRkTmV3Q2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBhZGRGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gIGFkZENhcmRQb3B1cEZvcm0ub3BlbigpO1xufSk7XG5cbi8vIEV2ZW50IGxpc3RlbmVyIGZvciBwcm9maWxlIGVkaXQgYnV0dG9uIGNsaWNrXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjb25zdCB7IHByb2ZpbGVOYW1lLCBkZXNjcmlwdGlvbiB9ID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgcHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZTtcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBkZXNjcmlwdGlvbjtcbiAgZWRpdEZvcm1WYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgZWRpdFBvcHVwRm9ybS5vcGVuKCk7XG59KTtcblxuYXZhdGFyRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBlZGl0QXZhdGFyVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gIGF2YXRhckVkaXRQb3B1cC5vcGVuKCk7XG59KTtcblxuLy90byByZW5kZXIgYSBjYXJkXG5mdW5jdGlvbiByZW5kZXJDYXJkKGNhcmREYXRhKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gbmV3IENhcmQoXG4gICAgY2FyZERhdGEsXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxuICAgIGhhbmRsZUNhcmRJbWFnZUNsaWNrLFxuICAgIGZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNsaWNrKCkge1xuICAgICAgY2FyZERlbGV0ZVBvcHVwLnNldFN1Ym1pdEFjdGlvbigoKSA9PiB7XG4gICAgICAgIGNhcmREZWxldGVQb3B1cC5zZXRMb2FkaW5nKHRydWUpO1xuICAgICAgICBhcGlcbiAgICAgICAgICAucmVtb3ZlQ2FyZChjYXJkRGF0YS5faWQpXG4gICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgY2FyZEVsZW1lbnQucmVtb3ZlQ2FyZEVsZW1lbnQocmVzLl9pZCk7XG4gICAgICAgICAgICBjYXJkRGVsZXRlUG9wdXAuY2xvc2UoKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxuICAgICAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgICAgIGNhcmREZWxldGVQb3B1cC5zZXRMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgLy8gY2FyZERlbGV0ZVBvcHVwLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgICAgY2FyZERlbGV0ZVBvcHVwLm9wZW4oKTtcbiAgICB9LFxuICAgIGZ1bmN0aW9uIGhhbmRsZUxpa2VCdXR0b25DbGljaygpIHtcbiAgICAgIGFwaVxuICAgICAgICAuY2hhbmdlTGlrZVN0YXR1cyhjYXJkRGF0YS5faWQsIGNhcmRFbGVtZW50LmlzTGlrZWQpXG4gICAgICAgIC50aGVuKChyZXMpID0+IGNhcmRFbGVtZW50LnVwZGF0ZUxpa2VzKHJlcy5pc0xpa2VkKSlcbiAgICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xuICAgIH1cbiAgKTtcbiAgLy8gc2VjdGlvbi5hZGRJdGVtKGNhcmQuZ2V0Q2FyZEVsZW1lbnQoKSk7XG4gIHJldHVybiBjYXJkRWxlbWVudC5nZXRDYXJkRWxlbWVudCgpO1xufVxuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSGFuZGxlcnMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8vIEV2ZW50IGhhbmRsZXIgZm9yIHByb2ZpbGUgZWRpdCBmb3JtIHN1Ym1pc3Npb25cbmZ1bmN0aW9uIGhhbmRsZUVkaXRQcm9maWxlU3VibWl0KGZvcm1EYXRhKSB7XG4gIGNvbnN0IHsgbmFtZUluZm8sIGpvYkluZm8gfSA9IGZvcm1EYXRhO1xuICBlZGl0UG9wdXBGb3JtLnNldExvYWRpbmcodHJ1ZSk7XG4gIGFwaVxuICAgIC5zZXRVc2VySW5mbyhuYW1lSW5mbywgam9iSW5mbylcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhcImhlcmVcIik7XG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhuYW1lSW5mbywgam9iSW5mbyk7XG4gICAgICBlZGl0UG9wdXBGb3JtLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBlZGl0UG9wdXBGb3JtLnNldExvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufVxuXG4vLyBFdmVudCBoYW5kbGVyIGZvciBhZGQgY2FyZCBmb3JtIHN1Ym1pc3Npb25cbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0KGlucHV0VmFsdWVzKSB7XG4gIGNvbnN0IHsgbmFtZSwgbGluayB9ID0gaW5wdXRWYWx1ZXM7XG4gIGFkZENhcmRQb3B1cEZvcm0uc2V0TG9hZGluZyh0cnVlKTtcbiAgYXBpXG4gICAgLmFkZENhcmQoeyBuYW1lLCBsaW5rIH0pXG4gICAgLnRoZW4oKGNhcmREYXRhKSA9PiB7XG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IHJlbmRlckNhcmQoY2FyZERhdGEpO1xuICAgICAgY2FyZFNlY3Rpb24ucHJlcGVuZEl0ZW0oY2FyZEVsZW1lbnQpO1xuICAgICAgYWRkQ2FyZFBvcHVwRm9ybS5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgYWRkQ2FyZFBvcHVwRm9ybS5zZXRMb2FkaW5nKGZhbHNlKTtcbiAgICB9KTtcbn1cblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGb3JtIFZhbGlkYXRpb24gICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4vLyBGb3JtIHZhbGlkYXRpb24gZm9yIGFkZCBjYXJkIGZvcm1cbmNvbnN0IGFkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgZm9ybVZhbGlkYXRvckNvbmZpZyxcbiAgcHJvZmlsZUFkZENhcmRGb3JtXG4pO1xuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbi8vIEZvcm0gdmFsaWRhdGlvbiBmb3IgcHJvZmlsZSBlZGl0IGZvcm1cbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXG4gIGZvcm1WYWxpZGF0b3JDb25maWcsXG4gIHByb2ZpbGVFZGl0Rm9ybVxuKTtcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgZWRpdEF2YXRhclZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICBmb3JtVmFsaWRhdG9yQ29uZmlnLFxuICBhdmF0YXJTdWJtaXRGb3JtXG4pO1xuZWRpdEF2YXRhclZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG4iLCIvLyBUaGlzIGNsYXNzIHJlcHJlc2VudHMgYW4gQVBJIGludGVyZmFjZSBmb3IgaW50ZXJhY3Rpbmcgd2l0aCBhIHNlcnZlciB0aGF0IHByb3ZpZGVzIGNhcmQgYW5kIHVzZXIgaW5mb3JtYXRpb24uXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIC8vIENvbnN0cnVjdG9yIHRvIGluaXRpYWxpemUgdGhlIEFQSSBpbnN0YW5jZSB3aXRoIGJhc2UgVVJMIGFuZCBoZWFkZXJzLlxyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDsgLy8gVGhlIGJhc2UgVVJMIG9mIHRoZSBBUEkuXHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVyczsgLy8gSGVhZGVycyB0byBiZSBpbmNsdWRlZCBpbiBBUEkgcmVxdWVzdHMuXHJcbiAgfVxyXG5cclxuICAvLyBQcml2YXRlIG1ldGhvZCB0byBoYW5kbGUgdGhlIHJlc3BvbnNlIGZyb20gdGhlIHNlcnZlci5cclxuICBfaGFuZGxlU2VydmVyUmVzcG9uc2UocmVzKSB7XHJcbiAgICByZXR1cm4gcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxuXHJcbiAgLy8gUHJpdmF0ZSBtZXRob2QgdG8gbWFrZSBhbiBBUEkgcmVxdWVzdCBhbmQgaGFuZGxlIHRoZSBzZXJ2ZXIgcmVzcG9uc2UuXHJcbiAgX3JlcXVlc3QodXJsLCBvcHRpb25zKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godXJsLCBvcHRpb25zKS50aGVuKHRoaXMuX2hhbmRsZVNlcnZlclJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIC8vIFB1YmxpYyBtZXRob2QgdG8gZmV0Y2ggaW5pdGlhbCBjYXJkIGluZm9ybWF0aW9uIGZyb20gdGhlIHNlcnZlci5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICBjb25zdCBjYXJkSW5mbyA9IHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KTtcclxuICAgIHJldHVybiBjYXJkSW5mbztcclxuICB9XHJcblxyXG4gIC8vIFB1YmxpYyBtZXRob2QgdG8gZmV0Y2ggdXNlciBpbmZvcm1hdGlvbiBmcm9tIHRoZSBzZXJ2ZXIuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICBjb25zdCB1c2VySW5mbyA9IHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KTtcclxuICAgIHJldHVybiB1c2VySW5mbztcclxuICB9XHJcblxyXG4gIC8vIFB1YmxpYyBtZXRob2QgdG8gdXBkYXRlIHVzZXIgaW5mb3JtYXRpb24gb24gdGhlIHNlcnZlci5cclxuICBzZXRVc2VySW5mbyhuYW1lLCBkZXNjcmlwdGlvbikge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgICBhYm91dDogZGVzY3JpcHRpb24sXHJcbiAgICAgIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWMgbWV0aG9kIHRvIGFkZCBhIG5ldyBjYXJkIG9uIHRoZSBzZXJ2ZXIuXHJcbiAgYWRkQ2FyZCh7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lLFxyXG4gICAgICAgIGxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWMgbWV0aG9kIHRvIHJlbW92ZSBhIGNhcmQgZnJvbSB0aGUgc2VydmVyLlxyXG4gIHJlbW92ZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gUHVibGljIG1ldGhvZCB0byBjaGFuZ2UgdGhlIGxpa2Ugc3RhdHVzIG9mIGEgY2FyZCBvbiB0aGUgc2VydmVyLlxyXG4gIGNoYW5nZUxpa2VTdGF0dXMoY2FyZElkLCBpc0xpa2VkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogaXNMaWtlZCA/IFwiREVMRVRFXCIgOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWMgbWV0aG9kIHRvIHVwZGF0ZSB0aGUgdXNlcidzIGF2YXRhciBvbiB0aGUgc2VydmVyLlxyXG4gIHNldFVzZXJBdmF0YXIodXJsKSB7XHJcbiAgICBjb25zb2xlLmxvZyhcInVybDpcIiArIHVybCk7IC8vIExvZyB0aGUgcHJvdmlkZWQgVVJMIGZvciBkZWJ1Z2dpbmcuXHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyOiB1cmwsXHJcbiAgICAgIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IobmFtZUVsZW1lbnQsIGpvYkVsZW1lbnQsIGF2YXRhcikge1xuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gbmFtZUVsZW1lbnQ7IC8vIFRoZSBET00gZWxlbWVudCB3aGVyZSB0aGUgdXNlcidzIG5hbWUgd2lsbCBiZSBkaXNwbGF5ZWRcbiAgICB0aGlzLl9qb2JFbGVtZW50ID0gam9iRWxlbWVudDsgLy8gVGhlIERPTSBlbGVtZW50IHdoZXJlIHRoZSB1c2VyJ3Mgam9iIGRlc2NyaXB0aW9uIHdpbGwgYmUgZGlzcGxheWVkXG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGF2YXRhcjtcbiAgfVxuXG4gIC8vIFJldHJpZXZlcyB0aGUgdXNlciBpbmZvIGZyb20gdGhlIERPTSBlbGVtZW50cyBhbmQgcmV0dXJucyBpdCBhcyBhbiBvYmplY3RcbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgY29uc3QgdXNlck9iamVjdCA9IHt9O1xuICAgIHVzZXJPYmplY3QucHJvZmlsZU5hbWUgPSB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudDtcbiAgICB1c2VyT2JqZWN0LmRlc2NyaXB0aW9uID0gdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudDtcbiAgICByZXR1cm4gdXNlck9iamVjdDtcbiAgfVxuXG4gIC8vIFNldHMgdGhlIHVzZXIgaW5mbyBpbiB0aGUgRE9NIGVsZW1lbnRzXG4gIHNldFVzZXJJbmZvKG5hbWVJbmZvLCBqb2JJbmZvKSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lSW5mbzsgLy8gU2V0cyB0aGUgdXNlcidzIG5hbWUgaW4gdGhlIG5hbWUgZWxlbWVudFxuICAgIHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQgPSBqb2JJbmZvOyAvLyBTZXRzIHRoZSB1c2VyJ3Mgam9iIGRlc2NyaXB0aW9uIGluIHRoZSBqb2IgZWxlbWVudFxuICB9XG5cbiAgc2V0VXNlckF2YXRhcihhdmF0YXIpIHtcbiAgICBjb25zb2xlLmxvZyhhdmF0YXIpO1xuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjID0gYXZhdGFyO1xuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQuYWx0ID0gdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQ7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgVXNlckluZm87XG4iLCJjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyRWxlbWVudCkge1xuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7IC8vIFRoZSBhcnJheSBvZiBpdGVtcyB0byByZW5kZXJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyOyAvLyBUaGUgcmVuZGVyaW5nIGZ1bmN0aW9uIHRvIGJlIGFwcGxpZWQgdG8gZWFjaCBpdGVtXG4gICAgdGhpcy5fY29udGFpbmVyRWxlbWVudCA9IGNvbnRhaW5lckVsZW1lbnQ7IC8vIFRoZSBjb250YWluZXIgZWxlbWVudCB3aGVyZSB0aGUgaXRlbXMgd2lsbCBiZSByZW5kZXJlZFxuICB9XG5cbiAgLy8gUmVuZGVycyBhbGwgaXRlbXMgaW4gdGhlIHNlY3Rpb24gdXNpbmcgdGhlIHByb3ZpZGVkIHJlbmRlcmVyIGZ1bmN0aW9uXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gLy9yZW5kZXJJdGVtcygpIHtcbiAgLy8gICB0aGlzLl9yZW5kZXJlZEl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgLy8gICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAvLyAgIH0pO1xuICAvLyB9XG5cbiAgLy8gQWRkcyBhbiBpdGVtIHRvIHRoZSBlbmQgb2YgdGhlIHNlY3Rpb25cbiAgYWRkSXRlbShjYXJkRWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lckVsZW1lbnQucHJlcGVuZChjYXJkRWxlbWVudCk7IC8vIEFwcGVuZHMgdGhlIGNhcmQgZWxlbWVudCB0byB0aGUgY29udGFpbmVyXG4gIH1cblxuICAvLyBBZGRzIGFuIGl0ZW0gdG8gdGhlIGJlZ2lubmluZyBvZiB0aGUgc2VjdGlvblxuICBwcmVwZW5kSXRlbShjYXJkRWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lckVsZW1lbnQucHJlcGVuZChjYXJkRWxlbWVudCk7IC8vIFByZXBlbmRzIHRoZSBjYXJkIGVsZW1lbnQgdG8gdGhlIGNvbnRhaW5lclxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFNlY3Rpb247XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbi8vIENsYXNzIGZvciBhIGNvbmZpcm1hdGlvbiBwb3B1cCB0aGF0IGV4dGVuZHMgdGhlIGJhc2UgUG9wdXAgY2xhc3NcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoQ29uZmlybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICAvLyBDYWxsIHRoZSBiYXNlIGNsYXNzIGNvbnN0cnVjdG9yXHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcblxyXG4gICAgLy8gU3RvcmUgcmVmZXJlbmNlcyB0byBwb3B1cCBmb3JtIGVsZW1lbnRzXHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5mb3JtX19idXR0b25fdHlwZV9kZWxldGVcIlxyXG4gICAgKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgfVxyXG5cclxuICAvLyBTZXQgdGhlIGFjdGlvbiB0byBiZSBleGVjdXRlZCB3aGVuIHRoZSBzdWJtaXQgYnV0dG9uIGlzIGNsaWNrZWRcclxuICBzZXRTdWJtaXRBY3Rpb24oYWN0aW9uKSB7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gYWN0aW9uO1xyXG4gIH1cclxuXHJcbiAgLy8gQ29udHJvbCB0aGUgbG9hZGluZyBzdGF0ZSBvZiB0aGUgc3VibWl0IGJ1dHRvblxyXG4gIHNldExvYWRpbmcoaXNMb2FkaW5nLCBsb2FkaW5nVGV4dCA9IFwiUmVtb3ZpbmcuLi5cIikge1xyXG4gICAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQ7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gQWRkIGV2ZW50IGxpc3RlbmVycyBmb3IgZm9ybSBzdWJtaXNzaW9uXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgLy8gRGVmaW5lIHRoZSBmb3JtIHN1Ym1pc3Npb24gaGFuZGxlclxyXG4gICAgdGhpcy5fZm9ybVN1Ym1pdEhhbmRsZXIgPSAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoZSk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIEF0dGFjaCB0aGUgaGFuZGxlciB0byB0aGUgZm9ybSdzIHN1Ym1pdCBldmVudFxyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5fZm9ybVN1Ym1pdEhhbmRsZXIpO1xyXG4gIH1cclxuXHJcbiAgLy8gUmVtb3ZlIGZvcm0gc3VibWlzc2lvbiBldmVudCBsaXN0ZW5lcnNcclxuICBfcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5fcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2Zvcm1TdWJtaXRIYW5kbGVyKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pOyAvLyBDYWxscyB0aGUgY29uc3RydWN0b3Igb2YgdGhlIHBhcmVudCBjbGFzcyAoUG9wdXApIGFuZCBwYXNzZXMgdGhlIHBvcHVwU2VsZWN0b3JcbiAgICB0aGlzLl9wcmV2aWV3SW1hZ2VFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcHJldmlldy1pbWFnZVwiKTsgLy8gVGhlIHByZXZpZXcgaW1hZ2UgZWxlbWVudCB3aXRoaW4gdGhlIHBvcHVwXG4gICAgdGhpcy5fcHJldmlld0ltYWdlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIubW9kYWxfX3ByZXZpZXctZGVzY3JpcHRpb25cIlxuICAgICk7IC8vIFRoZSBkZXNjcmlwdGlvbiBlbGVtZW50IHdpdGhpbiB0aGUgcG9wdXBcbiAgfVxuXG4gIC8vIE92ZXJyaWRlcyB0aGUgb3BlbiBtZXRob2Qgb2YgdGhlIHBhcmVudCBjbGFzcyAoUG9wdXApIHRvIGluY2x1ZGUgYWRkaXRpb25hbCBmdW5jdGlvbmFsaXR5XG4gIG9wZW4obmFtZSwgbGluaykge1xuICAgIHRoaXMuX3ByZXZpZXdJbWFnZUVsZW1lbnQuYWx0ID0gbmFtZTsgLy8gU2V0cyB0aGUgYWx0IGF0dHJpYnV0ZSBvZiB0aGUgcHJldmlldyBpbWFnZSBlbGVtZW50XG4gICAgdGhpcy5fcHJldmlld0ltYWdlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBuYW1lOyAvLyBTZXRzIHRoZSB0ZXh0IGNvbnRlbnQgb2YgdGhlIGRlc2NyaXB0aW9uIGVsZW1lbnRcbiAgICB0aGlzLl9wcmV2aWV3SW1hZ2VFbGVtZW50LnNyYyA9IGxpbms7IC8vIFNldHMgdGhlIHNyYyBhdHRyaWJ1dGUgb2YgdGhlIHByZXZpZXcgaW1hZ2UgZWxlbWVudFxuICAgIHN1cGVyLm9wZW4oKTsgLy8gQ2FsbHMgdGhlIG9wZW4gbWV0aG9kIG9mIHRoZSBwYXJlbnQgY2xhc3MgdG8gb3BlbiB0aGUgcG9wdXBcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhJbWFnZTtcbiIsImNsYXNzIENhcmQge1xuICAvLyBUaGUgY29uc3RydWN0b3IgZnVuY3Rpb24gaXMgY2FsbGVkIHdoZW4gYSBuZXcgaW5zdGFuY2Ugb2YgdGhlIGNsYXNzIGlzIGNyZWF0ZWQuXG4gIC8vIEl0IGluaXRpYWxpemVzIHRoZSBwcm9wZXJ0aWVzIG9mIHRoZSBjYXJkIGluc3RhbmNlLlxuICBjb25zdHJ1Y3RvcihcbiAgICBkYXRhLFxuICAgIHRlbXBsYXRlU2VsZWN0b3IsXG4gICAgaGFuZGxlQ2FyZEltYWdlQ2xpY2ssXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2ssXG4gICAgaGFuZGxlTGlrZUJ1dHRvbkNsaWNrLFxuICAgIHByZXZpZXdJbWFnZU1vZGFsLFxuICAgIHByZXZpZXdEZXNjcmlwdGlvbk1vZGFsXG4gICkge1xuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7IC8vIFRoZSBuYW1lIG9mIHRoZSBjYXJkXG5cbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rOyAvLyBUaGUgaW1hZ2UgbGluayBmb3IgdGhlIGNhcmRcbiAgICB0aGlzLmlzTGlrZWQgPSBkYXRhLmlzTGlrZWQ7XG4gICAgdGhpcy5fdGVtcGxhdGVTZWxlY3RvciA9IHRlbXBsYXRlU2VsZWN0b3I7IC8vIFRoZSBzZWxlY3RvciBmb3IgdGhlIGNhcmQncyBIVE1MIHRlbXBsYXRlXG4gICAgdGhpcy5faGFuZGxlQ2FyZEltYWdlQ2xpY2sgPSBoYW5kbGVDYXJkSW1hZ2VDbGljazsgLy8gRnVuY3Rpb24gdG8gaGFuZGxlIGNhcmQgaW1hZ2UgY2xpY2sgZXZlbnRcbiAgICB0aGlzLl9wcmV2aWV3SW1hZ2VNb2RhbCA9IHByZXZpZXdJbWFnZU1vZGFsOyAvLyBSZWZlcmVuY2UgdG8gdGhlIGltYWdlIHByZXZpZXcgbW9kYWxcbiAgICB0aGlzLl9wcmV2aWV3RGVzY3JpcHRpb25Nb2RhbCA9IHByZXZpZXdEZXNjcmlwdGlvbk1vZGFsOyAvLyBSZWZlcmVuY2UgdG8gdGhlIGRlc2NyaXB0aW9uIHByZXZpZXcgbW9kYWxcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VCdXR0b25DbGljayA9IGhhbmRsZUxpa2VCdXR0b25DbGljaztcbiAgfVxuXG4gIHJlbW92ZUNhcmRFbGVtZW50KCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xuICB9XG5cbiAgLy8gUmV0cmlldmVzIHRoZSBjYXJkIHRlbXBsYXRlIGZyb20gdGhlIERPTSBhbmQgY2xvbmVzIGl0XG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihgJHt0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yfWApXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xuICB9XG5cbiAgLy8gX2dldFRlbXBsYXRlKCkge1xuICAvLyAgIHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgLy8gICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRUZW1wbGF0ZVNlbGVjdG9yKVxuICAvLyAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gIC8vICAgICAuY2xvbmVOb2RlKHRydWUpO1xuICAvLyAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcbiAgLy8gfVxuXG4gIC8vIEV2ZW50IGhhbmRsZXIgZm9yIHRoZSBkZWxldGUgYnV0dG9uIGNsaWNrIGV2ZW50XG4gIF9oYW5kbGVEZWxldGVCdXR0b24oKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7IC8vIFJlbW92ZSB0aGUgY2FyZCBlbGVtZW50IGZyb20gdGhlIERPTVxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDsgLy8gU2V0IHRoZSBjYXJkIGVsZW1lbnQgdG8gbnVsbFxuICB9XG5cbiAgX3RvZ2dsZUxpa2VCdXR0b24oKSB7XG4gICAgaWYgKHRoaXMuaXNMaWtlZCkge1xuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgfVxuICB9XG5cbiAgdXBkYXRlTGlrZXMoaXNMaWtlZCkge1xuICAgIHRoaXMuaXNMaWtlZCA9IGlzTGlrZWQ7XG4gICAgdGhpcy5fdG9nZ2xlTGlrZUJ1dHRvbigpO1xuICB9XG5cbiAgLy8gRXZlbnQgaGFuZGxlciBmb3IgdGhlIGxpa2UgYnV0dG9uIGNsaWNrIGV2ZW50XG4gIF9oYW5kbGVMaWtlQnV0dG9uKCkge1xuICAgIC8vIFRvZ2dsZSB0aGUgJ2NhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZScgY2xhc3Mgb24gdGhlIGxpa2UgYnV0dG9uXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICB9XG5cbiAgLy8gU2V0cyB1cCBldmVudCBsaXN0ZW5lcnMgb24gdGhlIGNhcmQgZWxlbWVudFxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgLy8gRXZlbnQgbGlzdGVuZXIgZm9yIHRoZSBjYXJkIGltYWdlIGNsaWNrIGV2ZW50XG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZEltYWdlQ2xpY2soeyBuYW1lOiB0aGlzLl9uYW1lLCBsaW5rOiB0aGlzLl9saW5rIH0pO1xuICAgICAgfSk7XG5cbiAgICAvLyBFdmVudCBsaXN0ZW5lciBmb3IgdGhlIGRlbGV0ZSBidXR0b24gY2xpY2sgZXZlbnRcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVEZWxldGVDbGljaygpKTtcblxuICAgIC8vIEV2ZW50IGxpc3RlbmVyIGZvciB0aGUgbGlrZSBidXR0b24gY2xpY2sgZXZlbnRcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlTGlrZUJ1dHRvbkNsaWNrKCkpO1xuXG4gICAgLy8gdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxuICAgIC8vICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2soKVxuICAgIC8vICk7XG4gIH1cblxuICAvLyBDcmVhdGVzIGFuZCByZXR1cm5zIHRoZSBjYXJkIGVsZW1lbnRcbiAgZ2V0Q2FyZEVsZW1lbnQoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpOyAvLyBDbG9uZSB0aGUgY2FyZCB0ZW1wbGF0ZVxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7IC8vIFNldCB1cCBldmVudCBsaXN0ZW5lcnMgb24gdGhlIGNhcmQgZWxlbWVudFxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIikudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lOyAvLyBTZXQgdGhlIHRpdGxlIG9mIHRoZSBjYXJkXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKS5zcmMgPSB0aGlzLl9saW5rOyAvLyBTZXQgdGhlIGltYWdlIHNvdXJjZSBvZiB0aGUgY2FyZFxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIikuYWx0ID0gdGhpcy5fbmFtZTsgLy8gU2V0IHRoZSBhbHQgdGV4dCBvZiB0aGUgY2FyZCBpbWFnZVxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5jYXJkX19kZWxldGUtYnV0dG9uXCJcbiAgICApO1xuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuICAgIHRoaXMuX3RvZ2dsZUxpa2VCdXR0b24oKTtcblxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDsgLy8gUmV0dXJuIHRoZSBjYXJkIGVsZW1lbnRcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBDYXJkO1xuIl0sIm5hbWVzIjpbImNvbnN0cnVjdG9yIiwiX3JlZiIsInBvcHVwU2VsZWN0b3IiLCJ0aGlzIiwiX3BvcHVwRWxlbWVudCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIl9jbG9zZUJ5RXNjYXBlIiwiYmluZCIsIl9jbG9zZUJ5TW91c2VEb3duIiwib3BlbiIsImNsYXNzTGlzdCIsImFkZCIsIl9zZXRFdmVudExpc3RlbmVycyIsImNsb3NlIiwicmVtb3ZlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImUiLCJrZXkiLCJ0YXJnZXQiLCJjb250YWlucyIsImFkZEV2ZW50TGlzdGVuZXIiLCJjb25maWciLCJfZm9ybUVsIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbCIsImVycm9yTWVzc2FnZUVsIiwiaWQiLCJ0ZXh0Q29udGVudCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGFzSW52YWxpZElucHV0IiwiX2lucHV0RWxzIiwiZXZlcnkiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsIl9zdWJtaXRCdXR0b24iLCJkaXNhYmxlZCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiZW5hYmxlVmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwiUG9wdXAiLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9wb3B1cEZvcm0iLCJfaW5wdXRzIiwiX3N1Ym1pdEJ1dHRvblRleHQiLCJzZXRMb2FkaW5nIiwiaXNMb2FkaW5nIiwibG9hZGluZ1RleHQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJyZXNldCIsIl9zdWJtaXRGb3JtIiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRzT2JqZWN0IiwiaW5wdXQiLCJ2YWx1ZSIsIm5hbWUiLCJpbnB1dFZhbHVlcyIsImZvcm1WYWxpZGF0b3JDb25maWciLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVFZGl0TW9kYWwiLCJwcm9maWxlVGl0bGVJbnB1dCIsInByb2ZpbGVEZXNjcmlwdGlvbklucHV0IiwicHJvZmlsZUVkaXRGb3JtIiwiYWRkQ2FyZE1vZGFsIiwiYWRkTmV3Q2FyZEJ1dHRvbiIsInByb2ZpbGVBZGRDYXJkRm9ybSIsImNhcmRzV3JhcCIsImF2YXRhckVkaXRCdXR0b24iLCJhdmF0YXJTdWJtaXRGb3JtIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2hhbmRsZVNlcnZlclJlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsIl9yZXF1ZXN0IiwidXJsIiwib3B0aW9ucyIsImZldGNoIiwidGhlbiIsImdldEluaXRpYWxDYXJkcyIsImdldFVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJkZXNjcmlwdGlvbiIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJhZGRDYXJkIiwiX3JlZjIiLCJsaW5rIiwicmVtb3ZlQ2FyZCIsImNhcmRJZCIsImNoYW5nZUxpa2VTdGF0dXMiLCJpc0xpa2VkIiwic2V0VXNlckF2YXRhciIsImNvbnNvbGUiLCJsb2ciLCJhdmF0YXIiLCJhdXRob3JpemF0aW9uIiwiY2FyZFNlY3Rpb24iLCJ1c2VySW5mbyIsIm5hbWVFbGVtZW50Iiwiam9iRWxlbWVudCIsIl9uYW1lRWxlbWVudCIsIl9qb2JFbGVtZW50IiwiX2F2YXRhckVsZW1lbnQiLCJ1c2VyT2JqZWN0IiwicHJvZmlsZU5hbWUiLCJuYW1lSW5mbyIsImpvYkluZm8iLCJzcmMiLCJhbHQiLCJhbGwiLCJpbml0aWFsQ2FyZHMiLCJ1c2VyRGF0YSIsImNvbnRhaW5lckVsZW1lbnQiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lckVsZW1lbnQiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwiY2FyZEVsZW1lbnQiLCJwcmVwZW5kIiwicHJlcGVuZEl0ZW0iLCJjYXJkRGF0YSIsInJlbmRlckNhcmQiLCJjYXRjaCIsImVycm9yIiwiY2FyZERlbGV0ZVBvcHVwIiwic2V0U3VibWl0QWN0aW9uIiwiYWN0aW9uIiwiX2Zvcm1TdWJtaXRIYW5kbGVyIiwiX3JlbW92ZUV2ZW50TGlzdGVuZXJzIiwiYXZhdGFyRWRpdFBvcHVwIiwiUG9wdXBXaXRoRm9ybSIsImZpbmFsbHkiLCJwcmV2aWV3SW1hZ2VQb3B1cCIsIl9wcmV2aWV3SW1hZ2VFbGVtZW50IiwiX3ByZXZpZXdJbWFnZURlc2NyaXB0aW9uIiwiZWRpdFBvcHVwRm9ybSIsImZvcm1EYXRhIiwiYWRkQ2FyZFBvcHVwRm9ybSIsImhhbmRsZUNhcmRJbWFnZUNsaWNrIiwiX3JlZjMiLCJkYXRhIiwidGVtcGxhdGVTZWxlY3RvciIsImhhbmRsZURlbGV0ZUNsaWNrIiwiaGFuZGxlTGlrZUJ1dHRvbkNsaWNrIiwicHJldmlld0ltYWdlTW9kYWwiLCJwcmV2aWV3RGVzY3JpcHRpb25Nb2RhbCIsIl9uYW1lIiwiX2xpbmsiLCJfdGVtcGxhdGVTZWxlY3RvciIsIl9oYW5kbGVDYXJkSW1hZ2VDbGljayIsIl9wcmV2aWV3SW1hZ2VNb2RhbCIsIl9wcmV2aWV3RGVzY3JpcHRpb25Nb2RhbCIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9oYW5kbGVMaWtlQnV0dG9uQ2xpY2siLCJyZW1vdmVDYXJkRWxlbWVudCIsIl9jYXJkRWxlbWVudCIsIl9nZXRUZW1wbGF0ZSIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfaGFuZGxlRGVsZXRlQnV0dG9uIiwiX3RvZ2dsZUxpa2VCdXR0b24iLCJfbGlrZUJ1dHRvbiIsInVwZGF0ZUxpa2VzIiwiX2hhbmRsZUxpa2VCdXR0b24iLCJ0b2dnbGUiLCJnZXRDYXJkRWxlbWVudCIsIl9kZWxldGVCdXR0b24iLCJfaWQiLCJhZGRGb3JtVmFsaWRhdG9yIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJlZGl0QXZhdGFyVmFsaWRhdG9yIiwiRm9ybVZhbGlkYXRvciJdLCJzb3VyY2VSb290IjoiIn0=